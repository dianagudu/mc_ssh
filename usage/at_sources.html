<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Access Token source &#8212; mccli</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=6c7590d8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/fonts.css?v=09a796e2" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=8fd29722" />
    <script src="../_static/documentation_options.js?v=6dfdf7c3"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=7af948fa"></script>
    <link rel="icon" href="../_static/mccli.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Secure copy" href="usage_scp.html" />
    <link rel="prev" title="Usage" href="../usage.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
    <link rel="apple-touch-icon" href="../_static/logos/mccli-notext.png" />
  

  
  
    <link rel="canonical" href="https://mccli.readthedocs.io/usage/at_sources.html" />
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logos/mccli.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">SSH client wrapper for SSH with OIDC access token</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=dianagudu&repo=mccli&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../usage.html">Usage</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Access Token source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-options">Configuration options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage_scp.html">Secure copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh-options.html">SSH/SCP-specific options</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage_info.html">Retrieve information about user and server</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Additional configurations</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">mccli package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../usage.html">Usage</a><ul>
      <li>Previous: <a href="../usage.html" title="previous chapter">Usage</a></li>
      <li>Next: <a href="usage_scp.html" title="next chapter">Secure copy</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="access-token-source">
<span id="at-sources"></span><h1>Access Token source<a class="headerlink" href="#access-token-source" title="Link to this heading">¶</a></h1>
<p>You’ll need an OIDC Access Token to authenticate to the SSH server.</p>
<p>You might want to check out the <a class="reference external" href="https://github.com/indigo-dc/oidc-agent">oidc-agent</a> for that. It is a daemon that can provide valid access tokens from any number of configured OIDC Providers (OPs).</p>
<p>Once you get the <code class="docutils literal notranslate"><span class="pre">oidc-agent</span></code> running, configure an account for your preferred OP. For example, you can generate an account configuration for the <a class="reference external" href="https://aai.egi.eu/oidc">EGI AAI</a>  named <code class="docutils literal notranslate"><span class="pre">egi</span></code> as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>oidc-gen<span class="w"> </span>--pub<span class="w"> </span>--iss<span class="w"> </span>https://aai.egi.eu/oidc<span class="w"> </span>--scope<span class="w"> </span><span class="s2">&quot;openid profile email offline_access eduperson_entitlement eduperson_scoped_affiliation eduperson_unique_id&quot;</span><span class="w"> </span>egi
</pre></div>
</div>
<p>To use your EGI identity for SSH login, you can set the oidc-agent account in an environment variable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">OIDC_AGENT_ACCOUNT</span><span class="o">=</span>egi
</pre></div>
</div>
<p>If you have another way to retrieve OIDC access tokens, don’t worry. You can pass the token directly to the SSH command through an environment variable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">ACCESS_TOKEN</span><span class="o">=</span>&lt;paste<span class="w"> </span>your<span class="w"> </span>token<span class="w"> </span>here&gt;
</pre></div>
</div>
<section id="configuration-options">
<h2>Configuration options<a class="headerlink" href="#configuration-options" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">mccli</span></code> supports multiple ways of retrieving an Access Token.</p>
<p>They are shown below, in the order they are checked. The first source that is found will be used. If no source is specified, it will try to retrieve the supported token issuer from the service.</p>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-token">
<span class="sig-name descname"><span class="pre">--token</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;TOKEN&gt;</span></span><a class="headerlink" href="#cmdoption-token" title="Link to this definition">¶</a></dt>
<dd><p>Pass token directly.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-oa-account">
<span id="cmdoption-oidc"></span><span class="sig-name descname"><span class="pre">--oa-account</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--oidc</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;SHORTNAME&gt;</span></span><a class="headerlink" href="#cmdoption-oa-account" title="Link to this definition">¶</a></dt>
<dd><p>Name of configured account in oidc-agent.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-iss">
<span id="cmdoption-issuer"></span><span class="sig-name descname"><span class="pre">--iss</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--issuer</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;URL&gt;</span></span><a class="headerlink" href="#cmdoption-iss" title="Link to this definition">¶</a></dt>
<dd><p>URL of token issuer. Configured account in oidc-agent for this issuer will be used.</p>
</dd></dl>

<p class="rubric">Environment variables</p>
<p>Instead of the options above, environment variables can provide default values for the different sources.</p>
<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-ACCESS_TOKEN-OIDC-OS_ACCESS_TOKEN-OIDC_ACCESS_TOKEN-WATTS_TOKEN-WATTSON_TOKEN">
<span class="sig-name descname"><span class="pre">[ACCESS_TOKEN,</span> <span class="pre">OIDC,</span> <span class="pre">OS_ACCESS_TOKEN,</span> <span class="pre">OIDC_ACCESS_TOKEN,</span> <span class="pre">WATTS_TOKEN,</span> <span class="pre">WATTSON_TOKEN]</span></span><a class="headerlink" href="#envvar-ACCESS_TOKEN-OIDC-OS_ACCESS_TOKEN-OIDC_ACCESS_TOKEN-WATTS_TOKEN-WATTSON_TOKEN" title="Link to this definition">¶</a></dt>
<dd><p>provide a default for <a class="reference internal" href="#cmdoption-token"><code class="xref std std-option docutils literal notranslate"><span class="pre">--token</span></code></a></p>
</dd></dl>

<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-OIDC_AGENT_ACCOUNT">
<span class="sig-name descname"><span class="pre">[OIDC_AGENT_ACCOUNT]</span></span><a class="headerlink" href="#envvar-OIDC_AGENT_ACCOUNT" title="Link to this definition">¶</a></dt>
<dd><p>provide a default for <a class="reference internal" href="#cmdoption-oa-account"><code class="xref std std-option docutils literal notranslate"><span class="pre">--oa-account</span></code></a></p>
</dd></dl>

<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-OIDC_ISS-OIDC_ISSUER">
<span class="sig-name descname"><span class="pre">[OIDC_ISS,</span> <span class="pre">OIDC_ISSUER]</span></span><a class="headerlink" href="#envvar-OIDC_ISS-OIDC_ISSUER" title="Link to this definition">¶</a></dt>
<dd><p>provide a default for <a class="reference internal" href="#cmdoption-iss"><code class="xref std std-option docutils literal notranslate"><span class="pre">--iss</span></code></a></p>
</dd></dl>

</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../usage.html" title="Previous document">Usage</a>
        </li>
        <li>
          <a href="usage_scp.html" title="Next document">Secure copy</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2021-present, Diana Gudu.
      
    </div>

    

    
  </body>
</html>